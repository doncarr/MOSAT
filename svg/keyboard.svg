<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="100%" height="100%" viewBox="0 0 75 150" onload="load()" charset="UTF-8">
  <title>Embarcar</title>
  <metadata>author: Don Carr</metadata>

<g id="nextback_group">
<rect fill="burlywood" x="0%" y="0%" width="100%" height="100%" rx="4" ry="4" stroke="black" stroke-width="1"/>
<rect id="button_12" fill="cornsilk" x="2.5" y="128" width="35" height="20" stroke="black" stroke-width="1" rx="2" ry="2"/>
<text x="18.75" y="141" font-size="8" fill="black" text-anchor="middle">Atrás</text>
<rect x="2.5" y="128" width="35" height="20"  onclick="back_handler()" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect id="button_13" fill="cornsilk" x="37.5" y="128" width="35" height="20" stroke="black" stroke-width="1" rx="2" ry="2"/>
<text x="55.25" y="141" font-size="8" fill="black" text-anchor="middle">Sigue</text>
<rect x="37.5" y="128" width="35" height="20"  onclick="next_handler()" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
</g>

<g id="numeric_group">
<rect fill="burlywood" x="0" y="0" width="100%" height="127" rx="4" ry="4" stroke="black" stroke-width="1"/>
<text id="item_text" x="37.5" y="11" font-size="10" fill="black" text-anchor="middle"></text>
<text id="units_text" x="37.5" y="21" font-size="9" fill="black" text-anchor="middle"></text>
<rect fill="white" x="2.5" y="26" width="70" height="12" stroke="black" stroke-width="0.5"/>
<text id="the_text" x="37.5" y="35" font-size="10" fill="black" text-anchor="middle"></text>
<rect id="button_1" fill="cornsilk" x="8" y="45" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="18" y="60" font-size="15" fill="black" text-anchor="middle">1</text>
<text id="kalpha_1" visibility="hidden" x="18" y="64" font-size="7" fill="firebrick" text-anchor="middle">-</text>
<rect x="8" y="45" width="20" height="20"  onclick="button_click(1)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_2" fill="cornsilk" x="28" y="45" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="38" y="60" font-size="15" fill="black" text-anchor="middle">2</text>
<text id="kalpha_2" visibility="hidden" x="38" y="64" font-size="5" fill="firebrick" text-anchor="middle">ABC</text>
<rect x="28" y="45" width="20" height="20"  onclick="button_click(2)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_3" fill="cornsilk" x="48" y="45" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="58" y="60" font-size="15" fill="black" text-anchor="middle">3</text>
<text id="kalpha_3" visibility="hidden" x="58" y="64" font-size="5" fill="firebrick" text-anchor="middle">DEF</text>
<rect x="48" y="45" width="20" height="20"  onclick="button_click(3)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_4" fill="cornsilk" x="8" y="65" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="18" y="80" font-size="15" fill="black" text-anchor="middle">4</text>
<text id="kalpha_4" visibility="hidden" x="18" y="84" font-size="5" fill="firebrick" text-anchor="middle">GHI</text>
<rect x="8" y="65" width="20" height="20"  onclick="button_click(4)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_5" fill="cornsilk" x="28" y="65" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="38" y="80" font-size="15" fill="black" text-anchor="middle">5</text>
<text id="kalpha_5" visibility="hidden" x="38" y="84" font-size="5" fill="firebrick" text-anchor="middle">JKL</text>
<rect x="28" y="65" width="20" height="20"  onclick="button_click(5)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_6" fill="cornsilk" x="48" y="65" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="58" y="80" font-size="15" fill="black" text-anchor="middle">6</text>
<text id="kalpha_6" visibility="hidden" x="58" y="84" font-size="5" fill="firebrick" text-anchor="middle">MNO</text>
<rect x="48" y="65" width="20" height="20"  onclick="button_click(6)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_7" fill="cornsilk" x="8" y="85" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="18" y="100" font-size="15" fill="black" text-anchor="middle">7</text>
<text id="kalpha_7" visibility="hidden" x="18" y="104" font-size="5" fill="firebrick" text-anchor="middle">PQRS</text>
<rect x="8" y="85" width="20" height="20"  onclick="button_click(7)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_8" fill="cornsilk" x="28" y="85" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="38" y="100" font-size="15" fill="black" text-anchor="middle">8</text>
<text id="kalpha_8" visibility="hidden" x="38" y="104" font-size="5" fill="firebrick" text-anchor="middle">TUV</text>
<rect x="28" y="85" width="20" height="20"  onclick="button_click(8)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_9" fill="cornsilk" x="48" y="85" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="58" y="100" font-size="15" fill="black" text-anchor="middle">9</text>
<text id="kalpha_9" visibility="hidden" x="58" y="104" font-size="5" fill="firebrick" text-anchor="middle">WXYZ</text>
<rect x="48" y="85" width="20" height="20"  onclick="button_click(9)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_10" fill="cornsilk" x="8" y="105" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<polygon points="10,115 15,110 15,120" fill="black" stroke="none"/>
<line x1="15" y1="115" x2="26" y2="115" stroke ="black" stroke-width="2"/>
<rect x="8" y="105" width="20" height="20"  onclick="button_click(10)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_0" fill="cornsilk" x="28" y="105" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text x="38" y="120" font-size="15" fill="black" text-anchor="middle">0</text>
<text id="kalpha_0" visibility="hidden" x="38" y="123" font-size="5" fill="firebrick" text-anchor="middle">(espacio)</text>
<rect x="28" y="105" width="20" height="20"  onclick="button_click(0)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<rect id="button_11" fill="cornsilk" x="48" y="105" width="20" height="20" rx="2" ry="2" stroke="black" stroke-width="1"/>
<text id="period_text" x="58" y="120" font-size="15" fill="black" text-anchor="middle">.</text>
<rect x="48" y="105" width="20" height="20"  onclick="button_click(11)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
</g>


<g id="start_group">
<rect fill="burlywood" x="0" y="0" width="100%" height="100%" rx="4" ry="4" stroke="black" stroke-width="1"/>
<text x="35" y="8" font-size="7" fill="black" text-anchor="middle">Usuario</text>
<text x="35" y="18" font-size="7" fill="black" font-weight="bold" text-anchor="middle">Jose Ramirez</text>
<text x="35" y="30" font-size="7" fill="black" text-anchor="middle">Región</text>
<text x="35" y="40" font-size="7" fill="black" font-weight="bold" text-anchor="middle">Matamoros</text>
<text x="35" y="52" font-size="7" fill="black" text-anchor="middle">Silo</text>
<text x="35" y="62" font-size="7" fill="black" font-weight="bold" text-anchor="middle">AGROIND LAUREL</text>
<text x="35" y="74" font-size="7" fill="black" text-anchor="middle">Destino</text>
<text x="35" y="84" font-size="7" fill="black" font-weight="bold" text-anchor="middle">Celaya</text>

<rect fill="cornsilk" x="10" y="128" width="50" height="20" stroke="black" stroke-width="1" rx="2" ry="2"/>
<text x="35" y="141" font-size="8" fill="black" text-anchor="middle">Embarcar</text>
<rect x="5" y="128" width="60" height="20"  onclick="next_handler()" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

</g>

<g id="service_group">
<rect fill="burlywood" x="0" y="0" width="100%" height="127" rx="4" ry="4" stroke="black" stroke-width="1"/>
<text x="35" y="15" font-size="12" fill="black" text-anchor="middle">Servicios</text>

<rect fill="white" x="2.5" y="23" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_0" visibility="hidden">
    <line x1="2.5" y1="23" x2="12.5" y2="33" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="33" x2="12.5" y2="23" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="30" font-size="9" fill="black" text-anchor="start">Fumigación</text>
<rect x="2.5" y="22" width="70" height="12"  onclick="check_clicked(0)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect fill="white" x="2.5" y="40" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_1" visibility="hidden">
    <line x1="2.5" y1="40" x2="12.5" y2="50" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="50" x2="12.5" y2="40" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="47" font-size="9" fill="black" text-anchor="start">Hermetización</text>
<rect x="2.5" y="39" width="70" height="12"  onclick="check_clicked(1)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect fill="white" x="2.5" y="57" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_2" visibility="hidden">
    <line x1="2.5" y1="57" x2="12.5" y2="67" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="67" x2="12.5" y2="57" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="64" font-size="9" fill="black" text-anchor="start">Certificación</text>
<rect x="2.5" y="56" width="70" height="12"  onclick="check_clicked(2)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect fill="white" x="2.5" y="74" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_3" visibility="hidden">
    <line x1="2.5" y1="74" x2="12.5" y2="84" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="84" x2="12.5" y2="74" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="81" font-size="9" fill="black" text-anchor="start">Aspersión</text>
<rect x="2.5" y="73" width="70" height="12"  onclick="check_clicked(3)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect fill="white" x="2.5" y="91" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_4" visibility="hidden">
    <line x1="2.5" y1="91" x2="12.5" y2="101" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="101" x2="12.5" y2="91" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="98" font-size="9" fill="black" text-anchor="start">Aflotoxina</text>
<rect x="2.5" y="90" width="70" height="12"  onclick="check_clicked(4)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>

<rect fill="white" x="2.5" y="108" width="10" height="10" stroke="black" stroke-width="1"/>
  <g id="cb_5" visibility="hidden">
    <line x1="2.5" y1="108" x2="12.5" y2="118" stroke ="black" stroke-width="1"/>
    <line x1="2.5" y1="118" x2="12.5" y2="108" stroke ="black" stroke-width="1"/>
  </g>
<text x="15" y="115" font-size="9" fill="black" text-anchor="start">Fungistato</text>
<rect x="2.5" y="107" width="70" height="12"  onclick="check_clicked(5)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
</g>


<g id="list_group">
<rect fill="burlywood" x="0" y="0" width="100%" height="127" rx="4" ry="4" stroke="black" stroke-width="1"/>
<text id="list_name_text" x="37.5" y="11" font-size="10" fill="black" text-anchor="middle">Destino</text>
<rect fill="white" x="2.5" y="21" width="70" height="12" stroke="black" stroke-width="0.5"/>
<text id="list_item_text" x="37.5" y="31" font-size="10" fill="black" text-anchor="middle">Roma</text>
<circle id="list_white_0" fill="white" cx="7.5" cy="45" r="5" stroke="black" stroke-width="1"/>
  <g id="list_0" visibility="hidden">
<circle fill="black" cx="7.5" cy="45" r="3" stroke="none"/>
  </g>
<text id="list_item_text_0" x="15" y="47" font-size="9" fill="black" text-anchor="start">Roma</text>
<rect x="2.5" y="39" width="70" height="12"  onclick="list_clicked(0)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<circle id="list_white_1" fill="white" cx="7.5" cy="65" r="5" stroke="black" stroke-width="1"/>
  <g id="list_1" visibility="hidden">
<circle fill="black" cx="7.5" cy="65" r="3" stroke="none"/>
  </g>
<text id="list_item_text_1" x="15" y="67" font-size="9" fill="black" text-anchor="start">Paris</text>
<rect x="2.5" y="59" width="70" height="12"  onclick="list_clicked(1)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<circle id="list_white_2" fill="white" cx="7.5" cy="85" r="5" stroke="black" stroke-width="1"/>
  <g id="list_2" visibility="hidden">
<circle fill="black" cx="7.5" cy="85" r="3" stroke="none"/>
  </g>
<text id="list_item_text_2" x="15" y="87" font-size="9" fill="black" text-anchor="start">Londres</text>
<rect x="2.5" y="79" width="70" height="12"  onclick="list_clicked(2)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
<circle id="list_white_3" fill="white" cx="7.5" cy="105" r="5" stroke="black" stroke-width="1"/>
  <g id="list_3" visibility="hidden">
<circle fill="black" cx="7.5" cy="105" r="3" stroke="none"/>
  </g>
<text id="list_item_text_3" x="15" y="107" font-size="9" fill="black" text-anchor="start">Frankfurt</text>
<rect x="2.5" y="99" width="70" height="12"  onclick="list_clicked(3)" visibility="hidden" pointer-events="all" onmouseover="this.style.cursor='pointer';"/>
</g>
<script type="text/ecmascript"><![CDATA[
  const numeric_type=0;
  const list_type=1;
  const service_type=2;
  const start_type=3;
  const alpha_type=4;
  var text_obj;
  var item_obj;
  var numeric_obj;
  var service_obj;
  var start_obj;
  var nextback_obj;
  var list_obj;
  var units_obj;
  var decimal_point = false;
  var text_content="";
  var services= new Array(false, false, false, false, false, false);
  var item_n_count = new Array();

  var cb_objs = new Array();
  cb_objs[0] = document.getElementById("cb_0");
  cb_objs[1] = document.getElementById("cb_1");
  cb_objs[2] = document.getElementById("cb_2");
  cb_objs[3] = document.getElementById("cb_3");
  cb_objs[4] = document.getElementById("cb_4");
  cb_objs[5] = document.getElementById("cb_5");

  var kalpha_objs = new Array();
  kalpha_objs[0] = document.getElementById("kalpha_0");
  kalpha_objs[1] = document.getElementById("kalpha_1");
  kalpha_objs[2] = document.getElementById("kalpha_2");
  kalpha_objs[3] = document.getElementById("kalpha_3");
  kalpha_objs[4] = document.getElementById("kalpha_4");
  kalpha_objs[5] = document.getElementById("kalpha_5");
  kalpha_objs[6] = document.getElementById("kalpha_6");
  kalpha_objs[7] = document.getElementById("kalpha_7");
  kalpha_objs[8] = document.getElementById("kalpha_8");
  kalpha_objs[9] = document.getElementById("kalpha_9");

  var list_mode=false;
  var list_item=0;
  var current_item=0;
  const password_item=1;

  var list_objs = new Array();
  list_objs[0] = document.getElementById("list_0");
  list_objs[1] = document.getElementById("list_1");
  list_objs[2] = document.getElementById("list_2");
  list_objs[3] = document.getElementById("list_3");

  var list_white_objs = new Array();
  list_white_objs[0] = document.getElementById("list_white_0");
  list_white_objs[1] = document.getElementById("list_white_1");
  list_white_objs[2] = document.getElementById("list_white_2");
  list_white_objs[3] = document.getElementById("list_white_3");

  var list_text_objs = new Array();
  list_text_objs[0] = document.getElementById("list_item_text_0");
  list_text_objs[1] = document.getElementById("list_item_text_1");
  list_text_objs[2] = document.getElementById("list_item_text_2");
  list_text_objs[3] = document.getElementById("list_item_text_3");

  var list1_names = new Array();
  list1_names[0] = "Roma"
  list1_names[1] = "Paris"
  list1_names[2] = "Londres"
  list1_names[3] = "Frankfurt"

  var list2_names = new Array();
  list2_names[0] = "Diclorvos"
  list2_names[1] = "Deltametrina"

  var bobjs=new Array()

  const item_types= new Array(numeric_type, numeric_type, start_type, service_type, list_type, numeric_type,
      numeric_type, numeric_type, numeric_type, numeric_type,
      numeric_type, numeric_type, numeric_type, numeric_type,
      numeric_type, numeric_type, numeric_type, numeric_type,
      list_type, numeric_type, numeric_type, numeric_type, alpha_type, alpha_type);
  const item_descriptions = ["Usuario", "PIN", "Start", "Servicios", "Destino", "Peso Bruto",
        "Peso Tara", "Humedad", "Impureza", "Quebrados", "Picados",
        "Hongos", "Calor y Germ", "Otros Daños", "Peso Específico",
        "SanidadPrimaria", "SanidadSecundaria", "Temperatura",
        "Químico Aplicado", "Concentración", "Aflotoxin", "Fungistato", "Placas", "Chófer"];
  const units = ["2 digitos", "8 digitos", "", "", "", "toneladas", "toneladas", "%", "%", "%", "%",
      "%", "%", "%", "kg/m³", "N (insectos)", "N (insectos)", "\u00B0C", "", "ppm", "ppb", "%", "", ""];
  var item_values = ["", "", "", [false, false, false, false], 0, "", "", "", "", 
                "", "", "", "", "", "", "", "", "", 0, "", "", "", "", "", ""];
  const decimals =   [ 0, 0,-1,-1,-1, 3, 3,-1,-1,-1,-1,-1,-1,-1,0,0,0,-1,-1,-1,-1,-1,-1,-1];
  const dependency = [-1,-1,-1,-1,-1,-1,-1, 2, 2, 2, 2, 2, 2, 2,2,2,2, 2, 3, 3, 4, 5,-1,-1];
  const limit_max =  [-1,-1,-1,-1,-1,200,100,14,  2,2,2,2,1,5,800,0,2,35,-1,-1,-1,-1,-1,-1];
  const limit_min =  [-1,-1,-1,-1,-1, 30, 10,11.5,0,0,0,0,0,0,600,0,2, 0,-1,-1,-1,-1,-1,-1];


function b_timeout(n)
{
  bobjs[n].setAttribute("fill", "cornsilk");
}

function printGeo(pos) 
{
  console.log("latitude: " + pos.coords.latitude + ", longitude: " + pos.coords.longitude);
}

function geoError(error) 
{
  console.log("geo error: " + error.message);
}

function load()
{
  console.log("in load");
  current_item=0;
  period_obj = document.getElementById("period_text");
  text_obj = document.getElementById("the_text");
  item_obj = document.getElementById("item_text");
  list_item_obj = document.getElementById("list_item_text");
  list_name_obj = document.getElementById("list_name_text");
  units_obj = document.getElementById("units_text");
  numeric_obj = document.getElementById("numeric_group");
  service_obj = document.getElementById("service_group");
  start_obj = document.getElementById("start_group");
  nextback_obj = document.getElementById("nextback_group");
  list_obj = document.getElementById("list_group");

  for (var i=0; i < 14; i++)
  {
    bobjs[i] = document.getElementById("button_" + i);
  }
  console.log("text obj: " + text_obj);
  console.log("item obj: " + item_obj);
  item_obj.textContent=item_descriptions[0];
  units_obj.textContent=units[0];
  list_objs[0].setAttribute("visibility", "visible");
  var n_numeric=0;
  var n_list=0;
  var n_service=0;
  var n_alpha=0;
  var n_start=0;
  for (var i=0; i < item_types.length; i++)
  {
    switch (item_types[i])
    {
      case start_type:
        n_start++;
        item_n_count[i]=n_start;
      break;
      case alpha_type:
        n_alpha++;
        item_n_count[i]=n_alpha;
      break;
      case numeric_type:
        n_numeric++;
        item_n_count[i]=n_numeric;
      break;
      case service_type:
        n_service++;
        item_n_count[i]=n_service;
      break;
      case list_type:
        n_list++;
      item_n_count[i]=n_list;
      break;
    }
  }
  for (var i=0; i < item_types.length; i++)
  {
    console.log("[" + i + "] item_types: "+ item_types[i] + 
        " item_n_count: " + item_n_count[i]);
  }
  if ( navigator.geolocation )
  {
    navigator.geolocation.getCurrentPosition(printGeo, geoError,  {maximumAge:600000});
  }
  else
  {
    console.log("No support for geo location");
  }
  redisplay_item();

  console.log("location.hash: " + location.hash);
  console.log("location.host: " + location.host);
  console.log("location.hostname: " + location.hostname);
  console.log("location.href: " + location.href);
  console.log("location.pathname: " + location.pathname);
  console.log("location.port: " + location.port);
  console.log("location.protocol: " + location.protocol);
  console.log("location.search: " + location.search);
  console.log("navigator.appCodeName: " + navigator.appCodeName);
  console.log("navigator.appName: " + navigator.appName);
  console.log("navigator.appVersion: " + navigator.appVersion);
  console.log("navigator.cookieEnabled: " + navigator.cookieEnabled);
  console.log("navigator.platform: " + navigator.platform);
  console.log("navigator.userAgent: " + navigator.userAgent);
}

function list_clicked(n)
{
  var instance = item_n_count[current_item];
  var nmax=0;
  if (instance == 1) nmax=3;
  if (instance == 2) nmax=1;
  if (n > nmax) n = list_item;
  list_item=n;
  if (instance == 1)
  {
    list_item_obj.textContent=list1_names[n];
  }
  else
  {
    list_item_obj.textContent=list2_names[n];
  }
  for (var i=0; i < 4; i++)
  {
    if (i == n)
    {
      list_objs[i].setAttribute("visibility", "visible");
    }
    else
    {
      list_objs[i].setAttribute("visibility", "hidden");
    }
  }
  console.log("list item clicked: " + n + " ");
}

function check_clicked(n)
{
  services[n] = !services[n];
  //item_values[item_descriptions.length + n] = services[n];
  if (services[n])
  {
    cb_objs[n].setAttribute("visibility", "visible");
  }
  else
  {
    cb_objs[n].setAttribute("visibility", "hidden");
  }
  console.log("checkbox clicked: " + n + " ");
}

function redisplay_service(n, m)
{
}

function save_service(n, m)
{
  item_values[n]=services;
}

function redisplay_list(n, m)
{
  console.log("redisplay list, n: " + n + ", m: " + m);
  switch(m)
  {
    case 1:
      list_name_obj.textContent = "Destino";
      list_item_obj.textContent = list1_names[0];
      list_text_objs[0].textContent = list1_names[0];
      list_text_objs[1].textContent = list1_names[1];
      list_text_objs[2].textContent = list1_names[2];
      list_text_objs[3].textContent = list1_names[3];
      list_white_objs[0].setAttribute("visibility", "visible");
      list_white_objs[1].setAttribute("visibility", "visible");
      list_white_objs[2].setAttribute("visibility", "visible");
      list_white_objs[3].setAttribute("visibility", "visible");
    break;
    case 2:
      list_name_obj.textContent = "QuimicoAplicado";
      list_item_obj.textContent = list2_names[0];
      list_text_objs[0].textContent = list2_names[0];
      list_text_objs[1].textContent = list2_names[1];
      list_text_objs[2].textContent = "";
      list_text_objs[3].textContent = "";
      list_white_objs[0].setAttribute("visibility", "visible");
      list_white_objs[1].setAttribute("visibility", "visible");
      list_white_objs[2].setAttribute("visibility", "hidden");
      list_white_objs[3].setAttribute("visibility", "hidden");
    break;
  }
  list_item=item_values[n];
  list_clicked(list_item);
}

function save_list(n, m)
{
  item_values[n]=list_item;
}

function redisplay_numeric(n, m)
{
  text_content=item_values[n];
  if (decimals[n] != -1)
  {
    if (text_content.length > 0) text_content=parseFloat(text_content).toFixed(decimals[n])
  }
  text_obj.textContent=text_content;
  item_obj.textContent=item_descriptions[n];
  units_obj.textContent=units[n];
  //if (text_content.indexOf(".") == -1)
  if ((decimals[current_item] != 0) && (text_content.indexOf(".") == -1))
  {
    bobjs[11].setAttribute("visibility", "visible");
    period_obj.setAttribute("visibility", "visible");
    decimal_point = false; 
  }
  else
  {
    bobjs[11].setAttribute("visibility", "hidden");
    period_obj.setAttribute("visibility", "hidden");
    decimal_point = true;
  }
}

function save_numeric(n)
{
  item_values[n]=text_obj.textContent;
}

function redisplay_alpha(n, m)
{
  bobjs[11].setAttribute("visibility", "hidden");
  period_obj.setAttribute("visibility", "hidden");
  text_content=item_values[n];
  text_obj.textContent=text_content;
  item_obj.textContent=item_descriptions[n];
  units_obj.textContent=units[n];
}

function save_alpha(n)
{
  item_values[n]=text_obj.textContent;
}


function log_item_values()
{
  for (var i = 0; i < item_values.length; i++)
  {
    console.log(item_descriptions[i] + ": " + item_values[i]);
  }
  for (var i = 0; i < 4; i++)
  {
    console.log("service " + i + ": " + item_values[i + item_descriptions.length]);
  }
}

function redisplay_item()
{
  nextback_obj.parentNode.appendChild(nextback_obj);
  switch (item_types[current_item])
  {
    case alpha_type:
      show_alpha();
      numeric_obj.parentNode.appendChild(numeric_obj);
      redisplay_alpha(current_item, item_n_count[current_item])
    break;
    case numeric_type:
      hide_alpha();
      numeric_obj.parentNode.appendChild(numeric_obj);
      redisplay_numeric(current_item, item_n_count[current_item])
    break;
    case service_type:
      service_obj.parentNode.appendChild(service_obj);
      redisplay_service(current_item, item_n_count[current_item])
    break;
    case start_type:
      start_obj.parentNode.appendChild(start_obj);
    break;
    case list_type:
      list_obj.parentNode.appendChild(list_obj);
      redisplay_list(current_item, item_n_count[current_item])
    break;
  }
}

function save_item()
{
  switch (item_types[current_item])
  {
    case alpha_type:
      save_alpha(current_item, item_n_count[current_item])
    break;
    case numeric_type:
      save_numeric(current_item, item_n_count[current_item])
    break;
    case service_type:
      save_service(current_item, item_n_count[current_item])
    break;
    case list_type:
      save_list(current_item, item_n_count[current_item])
    break;
  }
}

function skip_back()
{
  var next = current_item - 1;
  while (true)
  {
    if (next < 2) return;
    if (dependency[next] == -1) // No dependency
    {
      current_item = next;
      return;
    }
    if (services[dependency[next]]) // The item has a dependency, and, it is met
    {
      current_item = next;
      return;
    }
    next--;
  }
  //if (current_item <= 0) {console.log("Under");}
  //if (current_item > 0) current_item--;
}

function back_handler()
{
  save_item();
  skip_back();
  redisplay_item();
  bobjs[12].setAttribute("fill", "gray");
  setTimeout("b_timeout(12)", 100);
}

function skip_forward()
{
  var next = current_item + 1;
  while (true)
  {
    if (next > (item_n_count.length - 1)) return;
    if (dependency[next] == -1) // No dependency
    {
      current_item = next;
      return;
    }
    if (services[dependency[next]]) // The item has a dependency, and, it is met
    {
      current_item = next;
      return;
    }
    next++;
  }
  //if (current_item >= (item_n_count.length - 1)) {console.log("OVER");}
  //if (current_item < (item_n_count.length - 1)) {current_item++;}
}

function next_handler()
{
  save_item();
  skip_forward();
  console.log("next redisplay, n: " + current_item + ", m: " + item_n_count[current_item]);
  redisplay_item();
  bobjs[13].setAttribute("fill", "gray");
  setTimeout("b_timeout(13)", 100);
}

function show_alpha()
{
  for (var i=0; i < 10; i++)
  {
    kalpha_objs[i].setAttribute("visibility", "visible");
  }
}

function hide_alpha()
{
  for (var i=0; i < 10; i++)
  {
    kalpha_objs[i].setAttribute("visibility", "hidden");
  }
}

var lastkey = -1;
var timeoutid;
var nkeys = 0;
const letras = [" 0", "-1", "ABC2", "DEF3", "GHI4", "JKL5", "MNO6", "PQRS7", "TUV8", "WXYZ9"] 
function alpha_timeout(n)
{
  bobjs[n].setAttribute("fill", "cornsilk");
  lastkey = -1;
}

function alpha_handler(n)
{
  console.log("alpha_handler " + n + ", current item: " + current_item);
  if (n > 10)
  {
    return;
  }
  else if (n == 10)
  {
    console.log("alpha_handler back space");
    text_content = text_content.substr(0,text_content.length - 1);
    bobjs[10].setAttribute("fill", "gray");
    setTimeout("b_timeout(10)", 100);
  }
  else if (n == lastkey)
  {
    console.log("Same key!!: " + n);
    nkeys++;
    if (nkeys >= letras[n].length) nkeys=0;
    clearTimeout(timeoutid);
    text_content = text_content.substr(0,text_content.length - 1);
    text_content = text_content + letras[n].substr(nkeys,1);
    timeoutid=setTimeout("alpha_timeout(" + n + ")", 500);
  }
  else
  {
    console.log("New key!!: " + n);
    if (lastkey != -1) 
    {
      clearTimeout(timeoutid);
      bobjs[lastkey].setAttribute("fill", "cornsilk");
    }
    lastkey = n;
    nkeys=0;
    timeoutid=setTimeout("alpha_timeout(" + n + ")", 500);
    text_content = text_content + letras[n].substr(0,1);
    bobjs[n].setAttribute("fill", "gray");
  }
  text_obj.textContent=text_content;
}

function numeric_handler(n)
{
  console.log("PRE: button clicked: " + n + ", current item: " + current_item);
  if (n < 10)
  {
    if (current_item == password_item)
    { 
      text_content = text_content + "*";
    }
    else
    {
      text_content = text_content + n.toString();
    }
  }
  else if (n == 10)
  {
    text_content = text_content.substr(0,text_content.length - 1);
  }
  else if (n == 11)
  {
    if (!decimal_point) text_content = text_content + ".";
  }
  text_obj.textContent=text_content;
  if ((decimals[current_item] != 0) && (text_content.indexOf(".") == -1))
  {
    bobjs[11].setAttribute("visibility", "visible");
    period_obj.setAttribute("visibility", "visible");
    decimal_point = false
  }
  else
  {
    bobjs[11].setAttribute("visibility", "hidden");
    period_obj.setAttribute("visibility", "hidden");
    decimal_point = true
  }
  if (current_item != 0)
  {
    //bobjs[12].setAttribute("visibility", "visible");
  }
  else
  {
    //bobjs[12].setAttribute("visibility", "hidden");
  }
  console.log("POST: button clicked: " + n + ", current item: " + current_item);
  bobjs[n].setAttribute("fill", "gray");
  setTimeout("b_timeout(" + n + ")", 100);
}

function button_click(n)
{
  switch (item_types[current_item])
  {
    case alpha_type:
      alpha_handler(n)
      break;
    case numeric_type:
      numeric_handler(n)
      break;
  }
}


]]></script>
</svg>
